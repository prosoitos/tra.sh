#+BEGIN_src html
<p align="center">
  <img src="https://user-images.githubusercontent.com/4634851/61600501-ce638580-abe5-11e9-9e7e-8b0ef6e19515.png"/>
</p>
#+END_src

# [[https://user-images.githubusercontent.com/4634851/61600501-ce638580-abe5-11e9-9e7e-8b0ef6e19515.png]]

This project is heavily influenced by [[https://github.com/andreafrancia/trash-cli][trash-cli]], but it makes use of the power of [[https://github.com/junegunn/fzf][fzf]] and add other functionality making listing and restoring trashed files and directories particularly easy.

** Functionality and comparison with trash-cli

As with [[https://github.com/andreafrancia/trash-cli][trash-cli]], tra.sh allows to:
- send files and directories to trash
- see the content of the trash easily
- restore these files/directories easily
- empty the trash based on cutoff date, pattern, etc. or fully clean it
- works from any mount point, for any user, and with sudo

tra.sh differs from [[https://github.com/andreafrancia/trash-cli][trash-cli]] in the following:
- tra.sh uses [[https://github.com/junegunn/fzf][fzf]] to find trashed files/directories very easily from pattern, name, path, or date
- files are listed chronologically (in reverse chronological order so that the last deleted file/directory is the easiest to access)
- trashed directories are marked with "D" to distinguish them from trashed files
- all files in ~$HOME/.local/share/Trash/files~ are listed, even if their meta data in ~$HOME/.local/share/Trash/info~ is missing for whatever reason
- it is possible to list and restore only the files which were trashed from the current directory ([[https://github.com/andreafrancia/trash-cli][trash-cli]]'s behaviour), but it is also possible to list all files/directories in the trash and restore any of them from any directory
- trashed files can be previewed with [[https://github.com/junegunn/fzf][fzf]]
- in case of a conflict between a new file and a restored trashed file, instead of exiting with error ([[https://github.com/andreafrancia/trash-cli][trash-cli]]'s behaviour), tra.sh will restore the file and turn the already existing file into a backup file with the suffix ~~conflict-with-restored-file~
- while [[https://github.com/andreafrancia/trash-cli][trash-cli]]'s ~trash-empty~ delete files from all the trashes of all mount points (except for the root trash which requires ~sudo trash-empty~), tra.sh will empty only the trash of the current mount point. This prevents the accidental deletion of files in the trash of an external drive when cleaning the user's trash, or reciprocally, the deletion of files in the user's trash when cleaning an external drive's trash

** Requirements

These scripts require [[https://github.com/junegunn/fzf][fzf]].

They are written on linux for zsh. Minor edits are likely to be necessary to run in bash or other shells (~$HOME/.local/share/Trash/files/*(D)~ to include dot files is zsh specific). ~date -d~ requires GNU date, which is not the default on macOS. On macOS, this expression will have to be changed slightly.

** Installation

Simply clone this repository or copy these scripts in your ~$PATH~.

** Usage

Simply run any of the scripts from the command line (or from ranger, rofi, or your usual way to run commands).

You might want to set aliases (in your ~.zshrc~ file, or ~alias.zsh~ file, or ~.bashrc~ file, or wherever you normally define shell aliases). That way, you only have to call the alias to run the corresponding script.

Here are suggested aliases:

**** Send files/directories to trash

#+BEGIN_src sh
alias t='zsh <path-to-tra.sh>/tra_sd.sh'
#+END_src

**** List trashed files/directories

- all
#+BEGIN_src sh
alias tls='zsh <path-to-tra.sh>/tra_ls.sh'
#+END_src

- only those trashed from the current directory
#+BEGIN_src sh
alias tlsd='zsh <path-to-tra.sh>/tra_ls_dir.sh'
#+END_src

- all, with preview
#+BEGIN_src sh
alias tlsp='zsh <path-to-tra.sh>/tra_ls_p.sh'
#+END_src

- only those trashed from the current directory, with preview
#+BEGIN_src sh
alias tlsdp='zsh <path-to-tra.sh>/tra_ls_dir_p.sh'
#+END_src

**** Restore trashed files/directories

- any
#+BEGIN_src sh
alias trs='zsh <path-to-tra.sh>/tra_rs.sh'
#+END_src

- only those trashed from current directory
#+BEGIN_src sh
alias trsd='zsh <path-to-tra.sh>/tra_rs_dir.sh'
#+END_src

- any, with preview
#+BEGIN_src sh
alias trsp='zsh <path-to-tra.sh>/tra_rs_p.sh'
#+END_src

- only those trashed from current directory, with preview
#+BEGIN_src sh
alias trsdp='zsh <path-to-tra.sh>/tra_rs_dir_p.sh'
#+END_src

**** Clean trash

- permanently delete all files/directories in the trash
#+BEGIN_src sh
alias tcl='zsh <path-to-tra.sh>/tra_cl.sh'
#+END_src

- only delete files/directories in the trash which are n days old or older
#+BEGIN_src sh
alias tcld='zsh <path-to-tra.sh>/tra_cl_date.sh'
# Add the number of days after this command
# For example, in order to delete all files/directories 3 days old or older, type:
# tcld 3
#+END_src

# - delete files/directories matching pattern
# #+BEGIN_src sh
# alias tclp='zsh <path-to-tra.sh>/tra_cl_pattern.sh'
# #+END_src

# #+BEGIN_src sh
# alias tcld='zsh <path-to-tra.sh>/tra_rm_p.sh'
# # Add the number of days after this command
# # For example, in order to delete all files/directories 3 days old or older, type:
# # tcld 3
# #+END_src
